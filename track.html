<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Collecte en cours...</title>
</head>
<body>
  <h1>Collecte des données...</h1>

  <script>
    // GÉOLOCALISATION
    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(
        (pos) => {
          const coords = `${pos.coords.latitude}, ${pos.coords.longitude}`;
          localStorage.setItem("geo", coords);
        },
        () => {
          localStorage.setItem("geo", "Refusée");
        }
      );
    } else {
      localStorage.setItem("geo", "Non supportée");
    }

    // INFOS NAVIGATEUR
    localStorage.setItem("browser", navigator.userAgent);

    // CAMÉRA & MICRO
    navigator.mediaDevices.getUserMedia({ video: true, audio: true })
      .then((stream) => {
        localStorage.setItem("cam", "Activée");
        localStorage.setItem("mic", "Activé");
        stream.getTracks().forEach(track => track.stop());
      })
      .catch(() => {
        localStorage.setItem("cam", "Refusée");
        localStorage.setItem("mic", "Refusé");
      });

    // REDIRECTION APRÈS 5 SECONDES
    setTimeout(() => {
      window.location.replace("index.html");
    }, 5000);
  </script>
</body>
</html>
